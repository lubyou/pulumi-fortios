// *** WARNING: this file was generated by the Pulumi Terraform Bridge (tfgen) Tool. ***
// *** Do not edit by hand unless you're certain you know what you are doing! ***

package fortios

import (
	"context"
	"reflect"

	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
)

// Configure FortiSwitch RSPAN/ERSPAN traffic sniffing parameters. Applies to FortiOS Version `>= 6.2.4`.
//
// ## Import
//
// SwitchController TrafficSniffer can be imported using any of these accepted formats
//
// ```sh
//  $ pulumi import fortios:index/switchControllerTrafficSniffer:SwitchControllerTrafficSniffer labelname SwitchControllerTrafficSniffer
// ```
//
//  If you do not want to import arguments of block$ export "FORTIOS_IMPORT_TABLE"="false"
//
// ```sh
//  $ pulumi import fortios:index/switchControllerTrafficSniffer:SwitchControllerTrafficSniffer labelname SwitchControllerTrafficSniffer
// ```
//
//  $ unset "FORTIOS_IMPORT_TABLE"
type SwitchControllerTrafficSniffer struct {
	pulumi.CustomResourceState

	// true or false, set this parameter to true when using dynamic forEach + toset to configure and sort sub-tables, please do not set this parameter when configuring static sub-tables.
	DynamicSortSubtable pulumi.StringPtrOutput `pulumi:"dynamicSortSubtable"`
	// Configure ERSPAN collector IP address.
	ErspanIp pulumi.StringOutput `pulumi:"erspanIp"`
	// Configure traffic sniffer mode. Valid values: `erspan-auto`, `rspan`, `none`.
	Mode pulumi.StringOutput `pulumi:"mode"`
	// Sniffer IPs to filter. The structure of `targetIp` block is documented below.
	TargetIps SwitchControllerTrafficSnifferTargetIpArrayOutput `pulumi:"targetIps"`
	// Sniffer MACs to filter. The structure of `targetMac` block is documented below.
	TargetMacs SwitchControllerTrafficSnifferTargetMacArrayOutput `pulumi:"targetMacs"`
	// Sniffer ports to filter. The structure of `targetPort` block is documented below.
	TargetPorts SwitchControllerTrafficSnifferTargetPortArrayOutput `pulumi:"targetPorts"`
	// Specifies the vdom to which the resource will be applied when the FortiGate unit is running in VDOM mode. Only one vdom can be specified. If you want to inherit the vdom configuration of the provider, please do not set this parameter.
	Vdomparam pulumi.StringPtrOutput `pulumi:"vdomparam"`
}

// NewSwitchControllerTrafficSniffer registers a new resource with the given unique name, arguments, and options.
func NewSwitchControllerTrafficSniffer(ctx *pulumi.Context,
	name string, args *SwitchControllerTrafficSnifferArgs, opts ...pulumi.ResourceOption) (*SwitchControllerTrafficSniffer, error) {
	if args == nil {
		args = &SwitchControllerTrafficSnifferArgs{}
	}

	opts = pkgResourceDefaultOpts(opts)
	var resource SwitchControllerTrafficSniffer
	err := ctx.RegisterResource("fortios:index/switchControllerTrafficSniffer:SwitchControllerTrafficSniffer", name, args, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// GetSwitchControllerTrafficSniffer gets an existing SwitchControllerTrafficSniffer resource's state with the given name, ID, and optional
// state properties that are used to uniquely qualify the lookup (nil if not required).
func GetSwitchControllerTrafficSniffer(ctx *pulumi.Context,
	name string, id pulumi.IDInput, state *SwitchControllerTrafficSnifferState, opts ...pulumi.ResourceOption) (*SwitchControllerTrafficSniffer, error) {
	var resource SwitchControllerTrafficSniffer
	err := ctx.ReadResource("fortios:index/switchControllerTrafficSniffer:SwitchControllerTrafficSniffer", name, id, state, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// Input properties used for looking up and filtering SwitchControllerTrafficSniffer resources.
type switchControllerTrafficSnifferState struct {
	// true or false, set this parameter to true when using dynamic forEach + toset to configure and sort sub-tables, please do not set this parameter when configuring static sub-tables.
	DynamicSortSubtable *string `pulumi:"dynamicSortSubtable"`
	// Configure ERSPAN collector IP address.
	ErspanIp *string `pulumi:"erspanIp"`
	// Configure traffic sniffer mode. Valid values: `erspan-auto`, `rspan`, `none`.
	Mode *string `pulumi:"mode"`
	// Sniffer IPs to filter. The structure of `targetIp` block is documented below.
	TargetIps []SwitchControllerTrafficSnifferTargetIp `pulumi:"targetIps"`
	// Sniffer MACs to filter. The structure of `targetMac` block is documented below.
	TargetMacs []SwitchControllerTrafficSnifferTargetMac `pulumi:"targetMacs"`
	// Sniffer ports to filter. The structure of `targetPort` block is documented below.
	TargetPorts []SwitchControllerTrafficSnifferTargetPort `pulumi:"targetPorts"`
	// Specifies the vdom to which the resource will be applied when the FortiGate unit is running in VDOM mode. Only one vdom can be specified. If you want to inherit the vdom configuration of the provider, please do not set this parameter.
	Vdomparam *string `pulumi:"vdomparam"`
}

type SwitchControllerTrafficSnifferState struct {
	// true or false, set this parameter to true when using dynamic forEach + toset to configure and sort sub-tables, please do not set this parameter when configuring static sub-tables.
	DynamicSortSubtable pulumi.StringPtrInput
	// Configure ERSPAN collector IP address.
	ErspanIp pulumi.StringPtrInput
	// Configure traffic sniffer mode. Valid values: `erspan-auto`, `rspan`, `none`.
	Mode pulumi.StringPtrInput
	// Sniffer IPs to filter. The structure of `targetIp` block is documented below.
	TargetIps SwitchControllerTrafficSnifferTargetIpArrayInput
	// Sniffer MACs to filter. The structure of `targetMac` block is documented below.
	TargetMacs SwitchControllerTrafficSnifferTargetMacArrayInput
	// Sniffer ports to filter. The structure of `targetPort` block is documented below.
	TargetPorts SwitchControllerTrafficSnifferTargetPortArrayInput
	// Specifies the vdom to which the resource will be applied when the FortiGate unit is running in VDOM mode. Only one vdom can be specified. If you want to inherit the vdom configuration of the provider, please do not set this parameter.
	Vdomparam pulumi.StringPtrInput
}

func (SwitchControllerTrafficSnifferState) ElementType() reflect.Type {
	return reflect.TypeOf((*switchControllerTrafficSnifferState)(nil)).Elem()
}

type switchControllerTrafficSnifferArgs struct {
	// true or false, set this parameter to true when using dynamic forEach + toset to configure and sort sub-tables, please do not set this parameter when configuring static sub-tables.
	DynamicSortSubtable *string `pulumi:"dynamicSortSubtable"`
	// Configure ERSPAN collector IP address.
	ErspanIp *string `pulumi:"erspanIp"`
	// Configure traffic sniffer mode. Valid values: `erspan-auto`, `rspan`, `none`.
	Mode *string `pulumi:"mode"`
	// Sniffer IPs to filter. The structure of `targetIp` block is documented below.
	TargetIps []SwitchControllerTrafficSnifferTargetIp `pulumi:"targetIps"`
	// Sniffer MACs to filter. The structure of `targetMac` block is documented below.
	TargetMacs []SwitchControllerTrafficSnifferTargetMac `pulumi:"targetMacs"`
	// Sniffer ports to filter. The structure of `targetPort` block is documented below.
	TargetPorts []SwitchControllerTrafficSnifferTargetPort `pulumi:"targetPorts"`
	// Specifies the vdom to which the resource will be applied when the FortiGate unit is running in VDOM mode. Only one vdom can be specified. If you want to inherit the vdom configuration of the provider, please do not set this parameter.
	Vdomparam *string `pulumi:"vdomparam"`
}

// The set of arguments for constructing a SwitchControllerTrafficSniffer resource.
type SwitchControllerTrafficSnifferArgs struct {
	// true or false, set this parameter to true when using dynamic forEach + toset to configure and sort sub-tables, please do not set this parameter when configuring static sub-tables.
	DynamicSortSubtable pulumi.StringPtrInput
	// Configure ERSPAN collector IP address.
	ErspanIp pulumi.StringPtrInput
	// Configure traffic sniffer mode. Valid values: `erspan-auto`, `rspan`, `none`.
	Mode pulumi.StringPtrInput
	// Sniffer IPs to filter. The structure of `targetIp` block is documented below.
	TargetIps SwitchControllerTrafficSnifferTargetIpArrayInput
	// Sniffer MACs to filter. The structure of `targetMac` block is documented below.
	TargetMacs SwitchControllerTrafficSnifferTargetMacArrayInput
	// Sniffer ports to filter. The structure of `targetPort` block is documented below.
	TargetPorts SwitchControllerTrafficSnifferTargetPortArrayInput
	// Specifies the vdom to which the resource will be applied when the FortiGate unit is running in VDOM mode. Only one vdom can be specified. If you want to inherit the vdom configuration of the provider, please do not set this parameter.
	Vdomparam pulumi.StringPtrInput
}

func (SwitchControllerTrafficSnifferArgs) ElementType() reflect.Type {
	return reflect.TypeOf((*switchControllerTrafficSnifferArgs)(nil)).Elem()
}

type SwitchControllerTrafficSnifferInput interface {
	pulumi.Input

	ToSwitchControllerTrafficSnifferOutput() SwitchControllerTrafficSnifferOutput
	ToSwitchControllerTrafficSnifferOutputWithContext(ctx context.Context) SwitchControllerTrafficSnifferOutput
}

func (*SwitchControllerTrafficSniffer) ElementType() reflect.Type {
	return reflect.TypeOf((**SwitchControllerTrafficSniffer)(nil)).Elem()
}

func (i *SwitchControllerTrafficSniffer) ToSwitchControllerTrafficSnifferOutput() SwitchControllerTrafficSnifferOutput {
	return i.ToSwitchControllerTrafficSnifferOutputWithContext(context.Background())
}

func (i *SwitchControllerTrafficSniffer) ToSwitchControllerTrafficSnifferOutputWithContext(ctx context.Context) SwitchControllerTrafficSnifferOutput {
	return pulumi.ToOutputWithContext(ctx, i).(SwitchControllerTrafficSnifferOutput)
}

// SwitchControllerTrafficSnifferArrayInput is an input type that accepts SwitchControllerTrafficSnifferArray and SwitchControllerTrafficSnifferArrayOutput values.
// You can construct a concrete instance of `SwitchControllerTrafficSnifferArrayInput` via:
//
//          SwitchControllerTrafficSnifferArray{ SwitchControllerTrafficSnifferArgs{...} }
type SwitchControllerTrafficSnifferArrayInput interface {
	pulumi.Input

	ToSwitchControllerTrafficSnifferArrayOutput() SwitchControllerTrafficSnifferArrayOutput
	ToSwitchControllerTrafficSnifferArrayOutputWithContext(context.Context) SwitchControllerTrafficSnifferArrayOutput
}

type SwitchControllerTrafficSnifferArray []SwitchControllerTrafficSnifferInput

func (SwitchControllerTrafficSnifferArray) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*SwitchControllerTrafficSniffer)(nil)).Elem()
}

func (i SwitchControllerTrafficSnifferArray) ToSwitchControllerTrafficSnifferArrayOutput() SwitchControllerTrafficSnifferArrayOutput {
	return i.ToSwitchControllerTrafficSnifferArrayOutputWithContext(context.Background())
}

func (i SwitchControllerTrafficSnifferArray) ToSwitchControllerTrafficSnifferArrayOutputWithContext(ctx context.Context) SwitchControllerTrafficSnifferArrayOutput {
	return pulumi.ToOutputWithContext(ctx, i).(SwitchControllerTrafficSnifferArrayOutput)
}

// SwitchControllerTrafficSnifferMapInput is an input type that accepts SwitchControllerTrafficSnifferMap and SwitchControllerTrafficSnifferMapOutput values.
// You can construct a concrete instance of `SwitchControllerTrafficSnifferMapInput` via:
//
//          SwitchControllerTrafficSnifferMap{ "key": SwitchControllerTrafficSnifferArgs{...} }
type SwitchControllerTrafficSnifferMapInput interface {
	pulumi.Input

	ToSwitchControllerTrafficSnifferMapOutput() SwitchControllerTrafficSnifferMapOutput
	ToSwitchControllerTrafficSnifferMapOutputWithContext(context.Context) SwitchControllerTrafficSnifferMapOutput
}

type SwitchControllerTrafficSnifferMap map[string]SwitchControllerTrafficSnifferInput

func (SwitchControllerTrafficSnifferMap) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*SwitchControllerTrafficSniffer)(nil)).Elem()
}

func (i SwitchControllerTrafficSnifferMap) ToSwitchControllerTrafficSnifferMapOutput() SwitchControllerTrafficSnifferMapOutput {
	return i.ToSwitchControllerTrafficSnifferMapOutputWithContext(context.Background())
}

func (i SwitchControllerTrafficSnifferMap) ToSwitchControllerTrafficSnifferMapOutputWithContext(ctx context.Context) SwitchControllerTrafficSnifferMapOutput {
	return pulumi.ToOutputWithContext(ctx, i).(SwitchControllerTrafficSnifferMapOutput)
}

type SwitchControllerTrafficSnifferOutput struct{ *pulumi.OutputState }

func (SwitchControllerTrafficSnifferOutput) ElementType() reflect.Type {
	return reflect.TypeOf((**SwitchControllerTrafficSniffer)(nil)).Elem()
}

func (o SwitchControllerTrafficSnifferOutput) ToSwitchControllerTrafficSnifferOutput() SwitchControllerTrafficSnifferOutput {
	return o
}

func (o SwitchControllerTrafficSnifferOutput) ToSwitchControllerTrafficSnifferOutputWithContext(ctx context.Context) SwitchControllerTrafficSnifferOutput {
	return o
}

type SwitchControllerTrafficSnifferArrayOutput struct{ *pulumi.OutputState }

func (SwitchControllerTrafficSnifferArrayOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*SwitchControllerTrafficSniffer)(nil)).Elem()
}

func (o SwitchControllerTrafficSnifferArrayOutput) ToSwitchControllerTrafficSnifferArrayOutput() SwitchControllerTrafficSnifferArrayOutput {
	return o
}

func (o SwitchControllerTrafficSnifferArrayOutput) ToSwitchControllerTrafficSnifferArrayOutputWithContext(ctx context.Context) SwitchControllerTrafficSnifferArrayOutput {
	return o
}

func (o SwitchControllerTrafficSnifferArrayOutput) Index(i pulumi.IntInput) SwitchControllerTrafficSnifferOutput {
	return pulumi.All(o, i).ApplyT(func(vs []interface{}) *SwitchControllerTrafficSniffer {
		return vs[0].([]*SwitchControllerTrafficSniffer)[vs[1].(int)]
	}).(SwitchControllerTrafficSnifferOutput)
}

type SwitchControllerTrafficSnifferMapOutput struct{ *pulumi.OutputState }

func (SwitchControllerTrafficSnifferMapOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*SwitchControllerTrafficSniffer)(nil)).Elem()
}

func (o SwitchControllerTrafficSnifferMapOutput) ToSwitchControllerTrafficSnifferMapOutput() SwitchControllerTrafficSnifferMapOutput {
	return o
}

func (o SwitchControllerTrafficSnifferMapOutput) ToSwitchControllerTrafficSnifferMapOutputWithContext(ctx context.Context) SwitchControllerTrafficSnifferMapOutput {
	return o
}

func (o SwitchControllerTrafficSnifferMapOutput) MapIndex(k pulumi.StringInput) SwitchControllerTrafficSnifferOutput {
	return pulumi.All(o, k).ApplyT(func(vs []interface{}) *SwitchControllerTrafficSniffer {
		return vs[0].(map[string]*SwitchControllerTrafficSniffer)[vs[1].(string)]
	}).(SwitchControllerTrafficSnifferOutput)
}

func init() {
	pulumi.RegisterInputType(reflect.TypeOf((*SwitchControllerTrafficSnifferInput)(nil)).Elem(), &SwitchControllerTrafficSniffer{})
	pulumi.RegisterInputType(reflect.TypeOf((*SwitchControllerTrafficSnifferArrayInput)(nil)).Elem(), SwitchControllerTrafficSnifferArray{})
	pulumi.RegisterInputType(reflect.TypeOf((*SwitchControllerTrafficSnifferMapInput)(nil)).Elem(), SwitchControllerTrafficSnifferMap{})
	pulumi.RegisterOutputType(SwitchControllerTrafficSnifferOutput{})
	pulumi.RegisterOutputType(SwitchControllerTrafficSnifferArrayOutput{})
	pulumi.RegisterOutputType(SwitchControllerTrafficSnifferMapOutput{})
}
